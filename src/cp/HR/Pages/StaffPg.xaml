<Page x:Class="HR.Pages.StaffPg"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:HR.Pages"
      xmlns:ctl="clr-namespace:HR.Controls"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:uc="clr-namespace:HR.Controls"
      xmlns:utils="clr-namespace:HR.Utilities"
      mc:Ignorable="d"
      d:DesignHeight="450" d:DesignWidth="800"
      Title="StaffPg" Loaded="Page_Loaded">
    <Page.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <utils:AddOneConverter x:Key="AddOneConv"/>
        <utils:InverseBooleanConverter x:Key="InvBoolConv"/>
        <utils:ImagePathConverter x:Key="ImgPathConv"/>
        <utils:InverseBoolToVisibilityConverter x:Key="InvBoolToVis"/>
        <utils:NotEmptyValidationRule x:Key="NotEmptyValidationRule"/>
    </Page.Resources>
    <StackPanel Margin="30">
        <StackPanel>
            <uc:Header HeaderText="Сотрудники"></uc:Header>
            <TextBlock Style="{StaticResource Paragraph}">
                Данный раздел содержит информацию о сотрудниках по категориям в соответствии с
                видами профессиональной деятельности и степенью участия в образовательном процессе.
            </TextBlock>
            <TextBlock Style="{StaticResource NoData}" Visibility="{Binding IsStaffEmpty, Converter={StaticResource BoolToVis}}">
                Информация о сотрудниках отсутствует
            </TextBlock>
            <StackPanel Visibility="{Binding IsStaffNotEmpty, Converter={StaticResource BoolToVis}}">
                <DockPanel>
                    <WrapPanel VerticalAlignment="Center">
                    <Grid>
                        <TextBox Width="200" Padding="5,0,25,0"
                                 Style="{StaticResource TextBoxMini}"
                                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                        />
                        <Button Style="{StaticResource ClearBtn}"
                                Click="ClearSearchButton_Click"
                                Visibility="{Binding IsSearchEmpty, Converter={StaticResource InvBoolToVis}}"
                                />
                    </Grid>
                    <Button Margin="5 0" Content="Найти" IsDefault="True" ToolTip="Поиск по ФИО"
                            Style="{StaticResource ButtonMini}" Background="{StaticResource BlueBrush}"
                            Click="SearchButton_Click" />
                    <TextBlock VerticalAlignment="Center" Margin="5 0" FontFamily="{StaticResource Roboto}">
                        <Run>Всего записей:</Run>
                        <Bold><Run Text="{Binding FilteredCount, Mode=OneWay}"></Run></Bold>
                    </TextBlock>
                    </WrapPanel>
                    <WrapPanel HorizontalAlignment="Right">
                        <ctl:IconHighlightButton Width="20" Height="20" Margin="5" ToolTip="Экспорт в PDF">
                            <StackPanel>
                                <Viewbox Stretch="Fill" Width="20" Height="20">
                                    <Path Fill="#da4953"
                                            Data="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 144-208 0c-35.3 0-64 28.7-64 64l0 144-48 0c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM176 352l32 0c30.9 0 56 25.1 56 56s-25.1 56-56 56l-16 0 0 32c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-48 0-80c0-8.8 7.2-16 16-16zm32 80c13.3 0 24-10.7 24-24s-10.7-24-24-24l-16 0 0 48 16 0zm96-80l32 0c26.5 0 48 21.5 48 48l0 64c0 26.5-21.5 48-48 48l-32 0c-8.8 0-16-7.2-16-16l0-128c0-8.8 7.2-16 16-16zm32 128c8.8 0 16-7.2 16-16l0-64c0-8.8-7.2-16-16-16l-16 0 0 96 16 0zm80-112c0-8.8 7.2-16 16-16l48 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 32 32 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 48c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-64 0-64z"/>
                                </Viewbox>
                            </StackPanel>
                        </ctl:IconHighlightButton>
                        <ctl:IconHighlightButton Width="20" Height="20" Margin="5" ToolTip="Экспорт в CSV">
                            <StackPanel>
                                <Viewbox Stretch="Fill" Width="20" Height="20">
                                    <Path Fill="#088409"
                                          Data="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 144-208 0c-35.3 0-64 28.7-64 64l0 144-48 0c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM200 352l16 0c22.1 0 40 17.9 40 40l0 8c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-8c0-4.4-3.6-8-8-8l-16 0c-4.4 0-8 3.6-8 8l0 80c0 4.4 3.6 8 8 8l16 0c4.4 0 8-3.6 8-8l0-8c0-8.8 7.2-16 16-16s16 7.2 16 16l0 8c0 22.1-17.9 40-40 40l-16 0c-22.1 0-40-17.9-40-40l0-80c0-22.1 17.9-40 40-40zm133.1 0l34.9 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-34.9 0c-7.2 0-13.1 5.9-13.1 13.1c0 5.2 3 9.9 7.8 12l37.4 16.6c16.3 7.2 26.8 23.4 26.8 41.2c0 24.9-20.2 45.1-45.1 45.1L304 512c-8.8 0-16-7.2-16-16s7.2-16 16-16l42.9 0c7.2 0 13.1-5.9 13.1-13.1c0-5.2-3-9.9-7.8-12l-37.4-16.6c-16.3-7.2-26.8-23.4-26.8-41.2c0-24.9 20.2-45.1 45.1-45.1zm98.9 0c8.8 0 16 7.2 16 16l0 31.6c0 23 5.5 45.6 16 66c10.5-20.3 16-42.9 16-66l0-31.6c0-8.8 7.2-16 16-16s16 7.2 16 16l0 31.6c0 34.7-10.3 68.7-29.6 97.6l-5.1 7.7c-3 4.5-8 7.1-13.3 7.1s-10.3-2.7-13.3-7.1l-5.1-7.7c-19.3-28.9-29.6-62.9-29.6-97.6l0-31.6c0-8.8 7.2-16 16-16z"/>
                                </Viewbox>
                            </StackPanel>
                        </ctl:IconHighlightButton>
                        <Button Margin="2 5" ToolTip="Печать"
                                Style="{StaticResource ButtonMini}" Background="#df7020"
                                Command="{Binding PrintCommand}"
                                >
                            <Viewbox Stretch="Fill" Width="12" Height="12">
                                <Path Fill="White"
                                    Data="M448 192V77.3c0-8.5-3.4-16.6-9.4-22.6L393.4 9.4c-6-6-14.1-9.4-22.6-9.4H96C78.3 0 64 14.3 64 32v160c-35.4 0-64 28.7-64 64v112c0 8.8 7.2 16 16 16h48v96c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32v-96h48c8.8 0 16-7.2 16-16V256c0-35.4-28.7-64-64-64zm-64 256H128v-96h256v96zm0-224H128V64h192v48c0 8.8 7.2 16 16 16h48v96zm48 72c-13.3 0-24-10.8-24-24 0-13.3 10.8-24 24-24s24 10.7 24 24c0 13.3-10.8 24-24 24z"/>
                            </Viewbox>
                        </Button>
                        <Button Margin="2 5" ToolTip="Отменить все изменения"
                                Style="{StaticResource ButtonMini}" Background="{StaticResource magentaDarkBrush}"
                                >
                            <Viewbox Stretch="Fill" Width="12" Height="12">
                                <Path Fill="White"
                                      Data="M212.3 224.3H12c-6.6 0-12-5.4-12-12V12C0 5.4 5.4 0 12 0h48c6.6 0 12 5.4 12 12v78.1C117.8 39.3 184.3 7.5 258.2 8c136.9 1 246.4 111.6 246.2 248.5C504 393.3 393.1 504 256.3 504c-64.1 0-122.5-24.3-166.5-64.2-5.1-4.6-5.3-12.6-.5-17.4l34-34c4.5-4.5 11.7-4.7 16.4-.5C170.8 415.3 211.6 432 256.3 432c97.3 0 176-78.7 176-176 0-97.3-78.7-176-176-176-58.5 0-110.3 28.5-142.3 72.3h98.3c6.6 0 12 5.4 12 12v48c0 6.6-5.4 12-12 12z"/>
                            </Viewbox>
                        </Button>
                        <Button Margin="2 5" ToolTip="Сохранить все изменения"
                        Style="{StaticResource ButtonMini}" Background="{StaticResource GreenDarkBrush}"
>
                            <Viewbox Stretch="Fill" Width="12" Height="12">
                                <Path Fill="White"
                              Data="M433.9 129.9l-83.9-83.9A48 48 0 0 0 316.1 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V163.9a48 48 0 0 0 -14.1-33.9zM224 416c-35.3 0-64-28.7-64-64 0-35.3 28.7-64 64-64s64 28.7 64 64c0 35.3-28.7 64-64 64zm96-304.5V212c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12V108c0-6.6 5.4-12 12-12h228.5c3.2 0 6.2 1.3 8.5 3.5l3.5 3.5A12 12 0 0 1 320 111.5z"/>
                            </Viewbox>
                        </Button>
                        <Button Margin="2 5" ToolTip="Добавить"
                                Style="{StaticResource ButtonMini}" Background="{StaticResource BlueBrush}"
                                >
                            <Viewbox Stretch="Fill" Width="12" Height="12">
                                <Path Fill="White"
                                      Data="M416 208H272V64c0-17.7-14.3-32-32-32h-32c-17.7 0-32 14.3-32 32v144H32c-17.7 0-32 14.3-32 32v32c0 17.7 14.3 32 32 32h144v144c0 17.7 14.3 32 32 32h32c17.7 0 32-14.3 32-32V304h144c17.7 0 32-14.3 32-32v-32c0-17.7-14.3-32-32-32z"/>
                            </Viewbox>
                        </Button>

                        <StackPanel Orientation="Horizontal">
                        <ToggleButton Width="25" Height="25" Margin="5 0" IsThreeState="False" ToolTip="Список"
                                      Style="{StaticResource IconToggleButtonPathStyle}"
                                      IsChecked="{Binding IsGridView, Mode=TwoWay, Converter={StaticResource InvBoolConv}}"
                        >
                            <Path Data="M149.3 216v80c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24v-80c0-13.3 10.7-24 24-24h101.3c13.3 0 24 10.7 24 24zM0 376v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24zM125.3 32H24C10.7 32 0 42.7 0 56v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24zm80 448H488c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H205.3c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24zm-24-424v80c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24H205.3c-13.3 0-24 10.7-24 24zm24 264H488c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H205.3c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24z"
                                  Stretch="Uniform" Width="20" Height="20"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}"
                            />
                        </ToggleButton>
                        <ToggleButton Width="25" Height="25" IsThreeState="False" ToolTip="Таблица"
                                      Style="{StaticResource IconToggleButtonPathStyle}"
                                      IsChecked="{Binding IsGridView, Mode=TwoWay}"
                                      >
                            <Path Data="M149.3 56v80c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V56c0-13.3 10.7-24 24-24h101.3c13.3 0 24 10.7 24 24zm181.3 240v-80c0-13.3-10.7-24-24-24H205.3c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24zm32-240v80c0 13.3 10.7 24 24 24H488c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24H386.7c-13.3 0-24 10.7-24 24zm-32 80V56c0-13.3-10.7-24-24-24H205.3c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24zm-205.3 56H24c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24zM0 376v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24zm386.7-56H488c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H386.7c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24zm0 160H488c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H386.7c-13.3 0-24 10.7-24 24v80c0 13.3 10.7 24 24 24zM181.3 376v80c0 13.3 10.7 24 24 24h101.3c13.3 0 24-10.7 24-24v-80c0-13.3-10.7-24-24-24H205.3c-13.3 0-24 10.7-24 24z"
                                  Stretch="Uniform" Width="20" Height="20"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}"
                            />
                        </ToggleButton>
                        </StackPanel>
                    </WrapPanel>
                </DockPanel>
                <DataGrid x:Name="EmployeesDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True"
                          AlternationCount="1000" HeadersVisibility="Column" VerticalScrollBarVisibility="Auto"
                          MaxHeight="300"
                          Visibility="{Binding IsGridView, Converter={StaticResource BoolToVis}}"
                          ItemsSource="{Binding Staff}"
                          >
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Редактировать"
                                      InputGestureText="Ctrl+E"
                                      IsEnabled="False"
                            >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Копировать"
                                      Command="ApplicationCommands.Copy"
                                      InputGestureText="Ctrl+C"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M320 448v40c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V120c0-13.3 10.7-24 24-24h72v296c0 30.9 25.1 56 56 56h168zm0-344V0H152c-13.3 0-24 10.7-24 24v368c0 13.3 10.7 24 24 24h272c13.3 0 24-10.7 24-24V128H344c-13.2 0-24-10.8-24-24zm121-31L375 7A24 24 0 0 0 358.1 0H352v96h96v-6.1a24 24 0 0 0 -7-17z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Удалить"
                                      Command="EditingCommands.Delete"
                                      InputGestureText="Del"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.7 23.7 0 0 0 -21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0 -16-16z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Добавить"
                                      Command="ApplicationCommands.New"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="512" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M352 240v32c0 6.6-5.4 12-12 12h-88v88c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-88h-88c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h88v-88c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v88h88c6.6 0 12 5.4 12 12zm96-160v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-48 346V86c0-3.3-2.7-6-6-6H54c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Header="Сохранить"
                                      Command="ApplicationCommands.Save"
                                      InputGestureText="Ctrl+S"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M433.9 129.9l-83.9-83.9A48 48 0 0 0 316.1 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V163.9a48 48 0 0 0 -14.1-33.9zM224 416c-35.3 0-64-28.7-64-64 0-35.3 28.7-64 64-64s64 28.7 64 64c0 35.3-28.7 64-64 64zm96-304.5V212c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12V108c0-6.6 5.4-12 12-12h228.5c3.2 0 6.2 1.3 8.5 3.5l3.5 3.5A12 12 0 0 1 320 111.5z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Отменить"
                                      Command="ApplicationCommands.Undo"
                                      InputGestureText="Ctrl+Z"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M255.5 8c-66.3 .1-126.4 26.2-170.9 68.7L49 41C33.9 25.9 8 36.6 8 57.9V192c0 13.3 10.7 24 24 24h134.1c21.4 0 32.1-25.9 17-41l-41.8-41.8c30.9-28.9 70.8-44.9 113.2-45.3 92.4-.8 170.3 74 169.5 169.4C423.2 348 349.8 424 256 424c-41.1 0-80-14.7-110.6-41.6-4.7-4.2-11.9-3.9-16.4 .6L89.3 422.7c-4.9 4.9-4.6 12.8 .5 17.4C133.8 479.8 192.1 504 256 504c137 0 248-111 248-248C504 119.2 392.4 7.8 255.5 8z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Header="Печать"
                                      Click="PrintMenuItem_Click"
                                      InputGestureText="Ctrl+P"
                            >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16" Margin="-2 0 0 0">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M448 192V77.3c0-8.5-3.4-16.6-9.4-22.6L393.4 9.4c-6-6-14.1-9.4-22.6-9.4H96C78.3 0 64 14.3 64 32v160c-35.4 0-64 28.7-64 64v112c0 8.8 7.2 16 16 16h48v96c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32v-96h48c8.8 0 16-7.2 16-16V256c0-35.4-28.7-64-64-64zm-64 256H128v-96h256v96zm0-224H128V64h192v48c0 8.8 7.2 16 16 16h48v96zm48 72c-13.3 0-24-10.8-24-24 0-13.3 10.8-24 24-24s24 10.7 24 24c0 13.3-10.8 24-24 24z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Экспорт"
                                      InputGestureText="Ctrl+E"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16" HorizontalAlignment="Center">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                                <MenuItem Header="CSV"
                                          Command="ApplicationCommands.SaveAs"
                                >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16" HorizontalAlignment="Center">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 144-208 0c-35.3 0-64 28.7-64 64l0 144-48 0c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM200 352l16 0c22.1 0 40 17.9 40 40l0 8c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-8c0-4.4-3.6-8-8-8l-16 0c-4.4 0-8 3.6-8 8l0 80c0 4.4 3.6 8 8 8l16 0c4.4 0 8-3.6 8-8l0-8c0-8.8 7.2-16 16-16s16 7.2 16 16l0 8c0 22.1-17.9 40-40 40l-16 0c-22.1 0-40-17.9-40-40l0-80c0-22.1 17.9-40 40-40zm133.1 0l34.9 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-34.9 0c-7.2 0-13.1 5.9-13.1 13.1c0 5.2 3 9.9 7.8 12l37.4 16.6c16.3 7.2 26.8 23.4 26.8 41.2c0 24.9-20.2 45.1-45.1 45.1L304 512c-8.8 0-16-7.2-16-16s7.2-16 16-16l42.9 0c7.2 0 13.1-5.9 13.1-13.1c0-5.2-3-9.9-7.8-12l-37.4-16.6c-16.3-7.2-26.8-23.4-26.8-41.2c0-24.9 20.2-45.1 45.1-45.1zm98.9 0c8.8 0 16 7.2 16 16l0 31.6c0 23 5.5 45.6 16 66c10.5-20.3 16-42.9 16-66l0-31.6c0-8.8 7.2-16 16-16s16 7.2 16 16l0 31.6c0 34.7-10.3 68.7-29.6 97.6l-5.1 7.7c-3 4.5-8 7.1-13.3 7.1s-10.3-2.7-13.3-7.1l-5.1-7.7c-19.3-28.9-29.6-62.9-29.6-97.6l0-31.6c0-8.8 7.2-16 16-16z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="PDF"
                                      Command="ApplicationCommands.SaveAs"
                                      >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}"
                                                  Data="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 144-208 0c-35.3 0-64 28.7-64 64l0 144-48 0c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM176 352l32 0c30.9 0 56 25.1 56 56s-25.1 56-56 56l-16 0 0 32c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-48 0-80c0-8.8 7.2-16 16-16zm32 80c13.3 0 24-10.7 24-24s-10.7-24-24-24l-16 0 0 48 16 0zm96-80l32 0c26.5 0 48 21.5 48 48l0 64c0 26.5-21.5 48-48 48l-32 0c-8.8 0-16-7.2-16-16l0-128c0-8.8 7.2-16 16-16zm32 128c8.8 0 16-7.2 16-16l0-64c0-8.8-7.2-16-16-16l-16 0 0 96 16 0zm80-112c0-8.8 7.2-16 16-16l48 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 32 32 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 48c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-64 0-64z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Header="Поиск по ФИО"
                                      InputGestureText="Ctrl+F"
                            >
                                <MenuItem.Icon>
                                    <Viewbox Height="16" Width="16">
                                        <Canvas Height="496" Width="512">
                                            <Path Fill="{StaticResource BaseDarkBrush}" Stretch="Uniform"
                                                  Data="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6 .1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                                                <Path.RenderTransform>
                                                    <TranslateTransform X="0" Y="0"/>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Canvas>
                                    </Viewbox>
                                </MenuItem.Icon>
                            </MenuItem>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                    <DataGrid.Columns>
                        <!-- Столбец с нумерацией -->
                        <DataGridTemplateColumn Width="40" IsReadOnly="True">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock HorizontalAlignment="Center"
                                               Text="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=AlternationIndex, Converter={StaticResource AddOneConv}}"
                                               />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Фамилия" Width="*" Binding="{Binding Surname}" ElementStyle="{StaticResource TextBlockWithEllipsisStyle}" />
                        <DataGridTextColumn Header="Имя" Width="*" Binding="{Binding GivenName}" ElementStyle="{StaticResource TextBlockWithEllipsisStyle}" />
                        <DataGridTextColumn Header="Отчество" Width="*" Binding="{Binding Patronymic}" ElementStyle="{StaticResource TextBlockWithEllipsisStyle}" />
                        <DataGridTextColumn Header="Стаж (лет)" Width="*" Binding="{Binding Experience}"
                                            CellStyle="{StaticResource RightAlignedCellStyle}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300">
                <ItemsControl ItemsSource="{Binding Staff}"
                              Visibility="{Binding IsGridView, Converter={StaticResource InvBoolToVis}}"
                              >
                    <ItemsControl.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Копировать" Click="CopyStaff_Click" InputGestureText="Ctrl+C" />
                            <MenuItem Header="Печать" Click="PrintStaff_Click" InputGestureText="Ctrl+P" />
                        </ContextMenu>
                    </ItemsControl.ContextMenu>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="0 10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="100" />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <HeaderedContentControl Header="{Binding FullName}"></HeaderedContentControl>
                                        <TextBlock Style="{StaticResource ListItem}">
                                            <Bold><Run>Должность:</Run></Bold>
                                            <Run/>
                                        </TextBlock>
                                        <TextBlock Style="{StaticResource ListItem}">
                                            <Bold><Run>Стаж работы:</Run></Bold>
                                            <Run Text="{Binding Experience, Mode=OneWay}"/>
                                            <Run>лет</Run>
                                        </TextBlock>
                                        <TextBlock Style="{StaticResource ListItem}">
                                            <Bold><Run>Подразделение:</Run></Bold>
                                            <Run/>
                                        </TextBlock>
                                    </StackPanel>
                                    <Image Grid.Column="1" Source="{Binding Image, Converter={StaticResource ImgPathConv}}"
                                           Cursor="Hand" ToolTip="Увеличить"
                                           MouseLeftButtonUp="Image_MouseLeftButtonUp" />
                                    <Popup StaysOpen="False" AllowsTransparency="True" Placement="MousePoint">
                                        <Border BorderBrush="LightGray" BorderThickness="1" Background="White"
                                                CornerRadius="5" Padding="10"
                                                >
                                            <ScrollViewer MaxWidth="500" VerticalScrollBarVisibility="Hidden">
                                                <Image />
                                            </ScrollViewer>
                                        </Border>
                                    </Popup>
                                </Grid>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                </ScrollViewer>
            </StackPanel>
        </StackPanel>
    </StackPanel>
</Page>
